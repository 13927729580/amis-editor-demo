{"version":3,"sources":["/store/index.ts"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import {types, getEnv, applySnapshot, getSnapshot} from 'mobx-state-tree';\nimport {PageStore} from './Page';\nimport {when, reaction} from 'mobx';\nlet pagIndex = 1;\nexport const MainStore = types\n    .model('MainStore', {\n        pages: types.optional(types.array(PageStore), [\n            {\n                id: `${pagIndex}`,\n                path: 'hello-world',\n                label: 'Hello world',\n                icon: 'fa fa-file',\n                schema: {\n                    type: 'page',\n                    title: 'Hello world',\n                    body: '初始页面'\n                }\n            }\n        ]),\n        theme: 'default',\n        asideFixed: true,\n        asideFolded: false,\n        offScreen: false,\n        addPageIsOpen: false,\n        preview: false,\n        schema: types.frozen()\n    })\n    .views(self => ({\n        get fetcher() {\n            return getEnv(self).fetcher;\n        },\n        get notify() {\n            return getEnv(self).notify;\n        },\n        get alert() {\n            return getEnv(self).alert;\n        },\n        get copy() {\n            return getEnv(self).copy;\n        }\n    }))\n    .actions(self => {\n        function toggleAsideFolded() {\n            self.asideFolded = !self.asideFolded;\n        }\n\n        function toggleAsideFixed() {\n            self.asideFixed = !self.asideFixed;\n        }\n\n        function toggleOffScreen() {\n            self.offScreen = !self.offScreen;\n        }\n\n        function setAddPageIsOpen(isOpened: boolean) {\n            self.addPageIsOpen = isOpened;\n        }\n\n        function addPage(data: {label: string; path: string; icon?: string; schema?: any}) {\n            self.pages.push(\n                PageStore.create({\n                    ...data,\n                    id: `${++pagIndex}`\n                })\n            );\n        }\n\n        function removePageAt(index: number) {\n            self.pages.splice(index, 1);\n        }\n\n        function updatePageSchemaAt(index: number) {\n            self.pages[index].updateSchema(self.schema);\n        }\n\n        function updateSchema(value: any) {\n            self.schema = value;\n        }\n\n        function setPreview(value: boolean) {\n            self.preview = value;\n        }\n\n        return {\n            toggleAsideFolded,\n            toggleAsideFixed,\n            toggleOffScreen,\n            setAddPageIsOpen,\n            addPage,\n            removePageAt,\n            updatePageSchemaAt,\n            updateSchema,\n            setPreview,\n            afterCreate() {\n                // persist store\n                if (typeof window !== 'undefined' && window.localStorage) {\n                    const storeData = window.localStorage.getItem('store');\n                    if (storeData) applySnapshot(self, JSON.parse(storeData));\n\n                    reaction(\n                        () => getSnapshot(self),\n                        json => {\n                            window.localStorage.setItem('store', JSON.stringify(json));\n                        }\n                    );\n                }\n            }\n        };\n    });\n\nexport type IMainStore = typeof MainStore.Type;\n"]}