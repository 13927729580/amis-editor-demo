{"version":3,"sources":["/route/Preview.tsx"],"names":[],"mappings":"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","file":"Preview.js","sourcesContent":["import React from 'react';\nimport {observer, inject} from 'mobx-react';\nimport {IMainStore} from '../store';\nimport {Button, AsideNav, Layout, confirm} from 'amis';\nimport {RouteComponentProps, matchPath, Switch, Route} from 'react-router';\nimport {Link} from 'react-router-dom';\nimport NotFound from './NotFound';\nimport AMISRenderer from '../component/AMISRenderer';\nimport AddPageModal from '../component/AddPageModal';\n\nfunction isActive(link: any, location: any) {\n    const ret = matchPath(location.pathname, {\n        path: link ? link.replace(/\\?.*$/, '') : '',\n        exact: true,\n        strict: true\n    });\n\n    return !!ret;\n}\n\nexport default inject('store')(\n    observer(function({store, location, history}: {store: IMainStore} & RouteComponentProps) {\n        function renderHeader() {\n            return (\n                <div>\n                    <div className={`a-Layout-brandBar`}>\n                        <button onClick={store.toggleOffScreen} className=\"pull-right visible-xs\">\n                            <i className=\"glyphicon glyphicon-align-justify\"></i>\n                        </button>\n                        <div className={`a-Layout-brand`}>\n                            <i className=\"fa fa-paw\"></i>\n                            <span className=\"hidden-folded m-l-sm\">AMIS 编辑器</span>\n                        </div>\n                    </div>\n                    <div className={`a-Layout-headerBar`}>\n                        <div className=\"nav navbar-nav hidden-xs\">\n                            <Button\n                                level=\"link\"\n                                className=\"no-shadow navbar-btn\"\n                                onClick={store.toggleAsideFolded}\n                                tooltip=\"展开或收起侧边栏\"\n                                placement=\"bottom\"\n                                iconOnly\n                            >\n                                <i className={store.asideFolded ? 'fa fa-indent' : 'fa fa-dedent'} />\n                            </Button>\n                        </div>\n\n                        <div className=\"hidden-xs p-t-sm pull-right\">\n                            <Button size=\"sm\" className=\"m-r-xs\" level=\"success\" disabled disabledTip=\"Todo...\">\n                                全部导出\n                            </Button>\n                            <Button size=\"sm\" level=\"info\" onClick={() => store.setAddPageIsOpen(true)}>\n                                新增页面\n                            </Button>\n                        </div>\n                    </div>\n                </div>\n            );\n        }\n\n        function renderAside() {\n            const navigations = store.pages.map(item => ({\n                label: item.label,\n                path: `/${item.path}`,\n                icon: item.icon\n            }));\n            const paths = navigations.map(item => item.path);\n\n            return (\n                <AsideNav\n                    key={store.asideFolded ? 'folded-aside' : 'aside'}\n                    navigations={[\n                        {\n                            label: '导航',\n                            children: navigations\n                        }\n                    ]}\n                    renderLink={({link, toggleExpand, classnames: cx, depth}: any) => {\n                        if (link.hidden) {\n                            return null;\n                        }\n\n                        let children = [];\n\n                        if (link.children) {\n                            children.push(\n                                <span\n                                    key=\"expand-toggle\"\n                                    className={cx('AsideNav-itemArrow')}\n                                    onClick={e => toggleExpand(link, e)}\n                                ></span>\n                            );\n                        }\n\n                        link.badge &&\n                            children.push(\n                                <b key=\"badge\" className={cx(`AsideNav-itemBadge`, link.badgeClassName || 'bg-info')}>\n                                    {link.badge}\n                                </b>\n                            );\n\n                        if (link.icon) {\n                            children.push(<i key=\"icon\" className={cx(`AsideNav-itemIcon`, link.icon)} />);\n                        } else if (store.asideFolded && depth === 1) {\n                            children.push(\n                                <i\n                                    key=\"icon\"\n                                    className={cx(`AsideNav-itemIcon`, link.children ? 'fa fa-folder' : 'fa fa-info')}\n                                />\n                            );\n                        }\n\n                        link.active ||\n                            children.push(\n                                <i\n                                    key=\"delete\"\n                                    data-tooltip=\"删除\"\n                                    data-position=\"bottom\"\n                                    className={'navbtn fa fa-times'}\n                                    onClick={(e: React.MouseEvent) => {\n                                        e.preventDefault();\n                                        confirm('确认要删除').then(confirmed => {\n                                            confirmed && store.removePageAt(paths.indexOf(link.path));\n                                        });\n                                    }}\n                                />\n                            );\n\n                        children.push(\n                            <i\n                                key=\"edit\"\n                                data-tooltip=\"编辑\"\n                                data-position=\"bottom\"\n                                className={'navbtn fa fa-pencil'}\n                                onClick={(e: React.MouseEvent) => {\n                                    e.preventDefault();\n                                    history.push(`/edit/${paths.indexOf(link.path)}`);\n                                }}\n                            />\n                        );\n\n                        children.push(\n                            <span key=\"label\" className={cx('AsideNav-itemLabel')}>\n                                {link.label}\n                            </span>\n                        );\n\n                        return link.path ? (\n                            link.active ? (\n                                <a>{children}</a>\n                            ) : (\n                                <Link to={link.path[0] === '/' ? link.path : `${link.path}`}>{children}</Link>\n                            )\n                        ) : (\n                            <a\n                                onClick={\n                                    link.onClick ? link.onClick : link.children ? () => toggleExpand(link) : undefined\n                                }\n                            >\n                                {children}\n                            </a>\n                        );\n                    }}\n                    isActive={(link: any) =>\n                        isActive(link.path && link.path[0] === '/' ? link.path : `${link.path}`, location)\n                    }\n                />\n            );\n        }\n\n        function handleConfirm(value: {label: string; icon: string; path: string}) {\n            store.addPage({\n                ...value,\n                schema: {\n                    type: 'page',\n                    title: value.label,\n                    body: '这是你刚刚新增的页面。'\n                }\n            });\n            store.setAddPageIsOpen(false);\n        }\n\n        return (\n            <Layout\n                aside={renderAside()}\n                header={renderHeader()}\n                folded={store.asideFolded}\n                offScreen={store.offScreen}\n            >\n                <Switch>\n                    {store.pages.map(item => (\n                        <Route\n                            key={item.id}\n                            path={`/${item.path}`}\n                            render={() => <AMISRenderer schema={item.schema} />}\n                        />\n                    ))}\n                    <Route component={NotFound} />\n                </Switch>\n                <AddPageModal\n                    show={store.addPageIsOpen}\n                    onClose={() => store.setAddPageIsOpen(false)}\n                    onConfirm={handleConfirm}\n                    pages={store.pages.concat()}\n                />\n            </Layout>\n        );\n    })\n);\n"]}